<!DOCTYPE html>





<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 4.0.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=7.4.1">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=7.4.1">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=7.4.1">
  <link rel="mask-icon" href="/images/logo.svg?v=7.4.1" color="#222">
  <link rel="alternate" href="/atom.xml" title="Anna X" type="application/atom+xml">

<link rel="stylesheet" href="/css/main.css?v=7.4.1">


<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css?v=4.7.0">


<script id="hexo-configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '7.4.1',
    exturl: false,
    sidebar: {"position":"left","display":"post","offset":12,"onmobile":false},
    copycode: {"enable":false,"show_result":false,"style":null},
    back2top: {"enable":true,"sidebar":false,"scrollpercent":false},
    bookmark: {"enable":false,"color":"#222","save":"auto"},
    fancybox: false,
    mediumzoom: false,
    lazyload: false,
    pangu: false,
    algolia: {
      appID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    },
    localsearch: {"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},
    path: 'search.xml',
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    translation: {
      copy_button: 'Copy',
      copy_success: 'Copied',
      copy_failure: 'Copy failed'
    },
    sidebarPadding: 40
  };
</script>

  <meta name="description" content="Happy coding ...">
<meta property="og:type" content="website">
<meta property="og:title" content="Anna X">
<meta property="og:url" content="https:&#x2F;&#x2F;vmnet8.github.io&#x2F;index.html">
<meta property="og:site_name" content="Anna X">
<meta property="og:description" content="Happy coding ...">
<meta property="og:locale" content="en">
<meta name="twitter:card" content="summary">
  <link rel="canonical" href="https://vmnet8.github.io/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome: true,
    isPost: false,
    isPage: false,
    isArchive: false
  };
</script>

  <title>Anna X</title>
  








  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .logo,
  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-meta">

    <div>
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Anna X</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
        <p class="site-subtitle">Anna's Tech Blog</p>
      
  </div>

  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>
</div>


<nav class="site-nav">
  
  <ul id="menu" class="menu">
      
      
      
        
        <li class="menu-item menu-item-home">
      
    
      
      
        
      
        
      
        
      
    

    <a href="/" rel="section"><i class="fa fa-fw fa-home"></i>Home</a>

  </li>
      
      
      
        
        <li class="menu-item menu-item-about">
      
    
      
      
        
      
        
      
        
      
    

    <a href="/about/" rel="section"><i class="fa fa-fw fa-user"></i>About</a>

  </li>
      
      
      
        
        <li class="menu-item menu-item-tags">
      
    
      
      
        
      
        
      
        
          
        
      
    

    <a href="/tags/" rel="section"><i class="fa fa-fw fa-tags"></i>Tags<span class="badge">19</span></a>

  </li>
      
      
      
        
        <li class="menu-item menu-item-archives">
      
    
      
      
        
          
        
      
        
      
        
      
    

    <a href="/archives/" rel="section"><i class="fa fa-fw fa-archive"></i>Archives<span class="badge">49</span></a>

  </li>
      <li class="menu-item menu-item-search">
        <a href="javascript:;" target="_blank" rel="noopener" class="popup-trigger">
        
          <i class="fa fa-search fa-fw"></i>Search</a>
      </li>
    
  </ul>

</nav>
  <div class="site-search">
    <div class="popup search-popup">
    <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocorrect="off" autocapitalize="none"
           placeholder="Searching..." spellcheck="false"
           type="text" id="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result"></div>

</div>
<div class="search-pop-overlay"></div>

  </div>
</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
            

          <div id="content" class="content">
            

  <div class="posts-expand">
        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="en">
    <link itemprop="mainEntityOfPage" href="https://vmnet8.github.io/2020/06/16/Ansible-part10-net-tool-module-uri/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Anna X">
      <meta itemprop="description" content="Happy coding ...">
      <meta itemprop="image" content="https://avatars0.githubusercontent.com/u/34552097">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Anna X">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
            
            <a href="/2020/06/16/Ansible-part10-net-tool-module-uri/" class="post-title-link" itemprop="url">Ansible-part10: net tool module uri</a>
          
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              
                
              

              <time title="Created: 2020-06-16 19:40:45 / Modified: 19:50:38" itemprop="dateCreated datePublished" datetime="2020-06-16T19:40:45-07:00">2020-06-16</time>
            </span>
          
            

            
          

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="fa fa-comment-o"></i>
      </span>
        
      
      <span class="post-meta-item-text">Disqus: </span>
    
    <a title="disqus" href="/2020/06/16/Ansible-part10-net-tool-module-uri/#comments" itemprop="discussionUrl"><span class="post-comments-count disqus-comment-count" data-disqus-identifier="2020/06/16/Ansible-part10-net-tool-module-uri/" itemprop="commentCount"></span></a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>uri is a  net tool moudle, which interacts with HTTP and HTTPS web services and supports Digest, Basic and WSSE HTTP authentication mechanisms.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">tasks:</span><br><span class="line">    - name: Check that a page returns a status 200 </span><br><span class="line">      uri:</span><br><span class="line">        url: http://www.example.com</span><br><span class="line">        return_content: yes</span><br><span class="line">      register: this</span><br><span class="line">    - debug:</span><br><span class="line">        msg: &quot;&#123;&#123;this&#125;&#125;&quot;</span><br></pre></td></tr></table></figure>
<p>look at the output</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line">anna@ansible-controller:~/Desktop/ansible-code/inventory/modules/net-tools-modules$ ansible-playbook site1.yml </span><br><span class="line"></span><br><span class="line">PLAY [uri] ********************************************************************************************************************************************************************************************************************************************</span><br><span class="line"></span><br><span class="line">TASK [Gathering Facts] ********************************************************************************************************************************************************************************************************************************</span><br><span class="line">ok: [cube4200]</span><br><span class="line">ok: [ansible-node1]</span><br><span class="line"></span><br><span class="line">TASK [Check that a page returns a status 200] *********************************************************************************************************************************************************************************************************</span><br><span class="line">ok: [cube4200]</span><br><span class="line">ok: [ansible-node1]</span><br><span class="line"></span><br><span class="line">TASK [debug] ******************************************************************************************************************************************************************************************************************************************</span><br><span class="line">ok: [ansible-node1] =&gt; &#123;</span><br><span class="line">    &quot;msg&quot;: &#123;</span><br><span class="line">        &quot;accept_ranges&quot;: &quot;bytes&quot;, </span><br><span class="line">        &quot;age&quot;: &quot;478999&quot;, </span><br><span class="line">        &quot;cache_control&quot;: &quot;max-age=604800&quot;, </span><br><span class="line">        &quot;changed&quot;: false, </span><br><span class="line">        &quot;connection&quot;: &quot;close&quot;, </span><br><span class="line">        &quot;content&quot;: &quot;&lt;!doctype html&gt;\n&lt;html&gt;\n&lt;head&gt;\n    &lt;title&gt;Example Domain&lt;/title&gt;\n\n    &lt;meta charset=\&quot;utf-8\&quot; /&gt;\n    &lt;meta http-equiv=\&quot;Content-type\&quot; content=\&quot;text/html; charset=utf-8\&quot; /&gt;\n    &lt;meta name=\&quot;viewport\&quot; content=\&quot;width=device-width, initial-scale=1\&quot; /&gt;\n    &lt;style type=\&quot;text/css\&quot;&gt;\n    body &#123;\n        background-color: #f0f0f2;\n        margin: 0;\n        padding: 0;\n        font-family: -apple-system, system-ui, BlinkMacSystemFont, \&quot;Segoe UI\&quot;, \&quot;Open Sans\&quot;, \&quot;Helvetica Neue\&quot;, Helvetica, Arial, sans-serif;\n        \n    &#125;\n    div &#123;\n        width: 600px;\n        margin: 5em auto;\n        padding: 2em;\n        background-color: #fdfdff;\n        border-radius: 0.5em;\n        box-shadow: 2px 3px 7px 2px rgba(0,0,0,0.02);\n    &#125;\n    a:link, a:visited &#123;\n        color: #38488f;\n        text-decoration: none;\n    &#125;\n    @media (max-width: 700px) &#123;\n        div &#123;\n            margin: 0 auto;\n            width: auto;\n        &#125;\n    &#125;\n    &lt;/style&gt;    \n&lt;/head&gt;\n\n&lt;body&gt;\n&lt;div&gt;\n    &lt;h1&gt;Example Domain&lt;/h1&gt;\n    &lt;p&gt;This domain is for use in illustrative examples in documents. You may use this\n    domain in literature without prior coordination or asking for permission.&lt;/p&gt;\n    &lt;p&gt;&lt;a href=\&quot;https://www.iana.org/domains/example\&quot;&gt;More information...&lt;/a&gt;&lt;/p&gt;\n&lt;/div&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n&quot;, </span><br><span class="line">        &quot;content_length&quot;: &quot;1256&quot;, </span><br><span class="line">        &quot;content_type&quot;: &quot;text/html; charset=UTF-8&quot;, </span><br><span class="line">        &quot;cookies&quot;: &#123;&#125;, </span><br><span class="line">        &quot;cookies_string&quot;: &quot;&quot;, </span><br><span class="line">        &quot;date&quot;: &quot;Wed, 17 Jun 2020 02:39:51 GMT&quot;, </span><br><span class="line">        &quot;elapsed&quot;: 0, </span><br><span class="line">        &quot;etag&quot;: &quot;\&quot;3147526947\&quot;&quot;, </span><br><span class="line">        &quot;expires&quot;: &quot;Wed, 24 Jun 2020 02:39:51 GMT&quot;, </span><br><span class="line">        &quot;failed&quot;: false, </span><br><span class="line">        &quot;last_modified&quot;: &quot;Thu, 17 Oct 2019 07:18:26 GMT&quot;, </span><br><span class="line">        &quot;msg&quot;: &quot;OK (1256 bytes)&quot;, </span><br><span class="line">        &quot;redirected&quot;: false, </span><br><span class="line">        &quot;server&quot;: &quot;ECS (sjc/4E44)&quot;, </span><br><span class="line">        &quot;status&quot;: 200, </span><br><span class="line">        &quot;url&quot;: &quot;http://www.example.com&quot;, </span><br><span class="line">        &quot;vary&quot;: &quot;Accept-Encoding&quot;, </span><br><span class="line">        &quot;x_cache&quot;: &quot;HIT&quot;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">ok: [cube4200] =&gt; &#123;</span><br><span class="line">    &quot;msg&quot;: &#123;</span><br><span class="line">        &quot;accept_ranges&quot;: &quot;bytes&quot;, </span><br><span class="line">        &quot;age&quot;: &quot;478426&quot;, </span><br><span class="line">        &quot;cache_control&quot;: &quot;max-age=604800&quot;, </span><br><span class="line">        &quot;changed&quot;: false, </span><br><span class="line">        &quot;connection&quot;: &quot;close&quot;, </span><br><span class="line">        &quot;content&quot;: &quot;&lt;!doctype html&gt;\n&lt;html&gt;\n&lt;head&gt;\n    &lt;title&gt;Example Domain&lt;/title&gt;\n\n    &lt;meta charset=\&quot;utf-8\&quot; /&gt;\n    &lt;meta http-equiv=\&quot;Content-type\&quot; content=\&quot;text/html; charset=utf-8\&quot; /&gt;\n    &lt;meta name=\&quot;viewport\&quot; content=\&quot;width=device-width, initial-scale=1\&quot; /&gt;\n    &lt;style type=\&quot;text/css\&quot;&gt;\n    body &#123;\n        background-color: #f0f0f2;\n        margin: 0;\n        padding: 0;\n        font-family: -apple-system, system-ui, BlinkMacSystemFont, \&quot;Segoe UI\&quot;, \&quot;Open Sans\&quot;, \&quot;Helvetica Neue\&quot;, Helvetica, Arial, sans-serif;\n        \n    &#125;\n    div &#123;\n        width: 600px;\n        margin: 5em auto;\n        padding: 2em;\n        background-color: #fdfdff;\n        border-radius: 0.5em;\n        box-shadow: 2px 3px 7px 2px rgba(0,0,0,0.02);\n    &#125;\n    a:link, a:visited &#123;\n        color: #38488f;\n        text-decoration: none;\n    &#125;\n    @media (max-width: 700px) &#123;\n        div &#123;\n            margin: 0 auto;\n            width: auto;\n        &#125;\n    &#125;\n    &lt;/style&gt;    \n&lt;/head&gt;\n\n&lt;body&gt;\n&lt;div&gt;\n    &lt;h1&gt;Example Domain&lt;/h1&gt;\n    &lt;p&gt;This domain is for use in illustrative examples in documents. You may use this\n    domain in literature without prior coordination or asking for permission.&lt;/p&gt;\n    &lt;p&gt;&lt;a href=\&quot;https://www.iana.org/domains/example\&quot;&gt;More information...&lt;/a&gt;&lt;/p&gt;\n&lt;/div&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n&quot;, </span><br><span class="line">        &quot;content_length&quot;: &quot;1256&quot;, </span><br><span class="line">        &quot;content_type&quot;: &quot;text/html; charset=UTF-8&quot;, </span><br><span class="line">        &quot;cookies&quot;: &#123;&#125;, </span><br><span class="line">        &quot;cookies_string&quot;: &quot;&quot;, </span><br><span class="line">        &quot;date&quot;: &quot;Wed, 17 Jun 2020 02:39:50 GMT&quot;, </span><br><span class="line">        &quot;elapsed&quot;: 0, </span><br><span class="line">        &quot;etag&quot;: &quot;\&quot;3147526947\&quot;&quot;, </span><br><span class="line">        &quot;expires&quot;: &quot;Wed, 24 Jun 2020 02:39:50 GMT&quot;, </span><br><span class="line">        &quot;failed&quot;: false, </span><br><span class="line">        &quot;last_modified&quot;: &quot;Thu, 17 Oct 2019 07:18:26 GMT&quot;, </span><br><span class="line">        &quot;msg&quot;: &quot;OK (1256 bytes)&quot;, </span><br><span class="line">        &quot;redirected&quot;: false, </span><br><span class="line">        &quot;server&quot;: &quot;ECS (sjc/4E76)&quot;, </span><br><span class="line">        &quot;status&quot;: 200, </span><br><span class="line">        &quot;url&quot;: &quot;http://www.example.com&quot;, </span><br><span class="line">        &quot;vary&quot;: &quot;Accept-Encoding&quot;, </span><br><span class="line">        &quot;x_cache&quot;: &quot;HIT&quot;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">PLAY RECAP ********************************************************************************************************************************************************************************************************************************************</span><br><span class="line">ansible-node1              : ok=3    changed=0    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   </span><br><span class="line">cube4200                   : ok=3    changed=0    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0</span><br></pre></td></tr></table></figure>
<p>Notice: if there is no <code>return_content: yes</code>, the output will only parts of above info.<br>the status is 200, which means it is normal.</p>

        
      
    </div>

    
    
    
      <footer class="post-footer">
          <div class="post-eof"></div>
        
      </footer>
  </article>
  
  
  

    
        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="en">
    <link itemprop="mainEntityOfPage" href="https://vmnet8.github.io/2020/06/16/Ansible-part9-fetch-url-module/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Anna X">
      <meta itemprop="description" content="Happy coding ...">
      <meta itemprop="image" content="https://avatars0.githubusercontent.com/u/34552097">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Anna X">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
            
            <a href="/2020/06/16/Ansible-part9-fetch-url-module/" class="post-title-link" itemprop="url">Ansible part9: fetch file from remote</a>
          
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              
                
              

              <time title="Created: 2020-06-16 18:07:35 / Modified: 18:38:55" itemprop="dateCreated datePublished" datetime="2020-06-16T18:07:35-07:00">2020-06-16</time>
            </span>
          
            

            
          

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="fa fa-comment-o"></i>
      </span>
        
      
      <span class="post-meta-item-text">Disqus: </span>
    
    <a title="disqus" href="/2020/06/16/Ansible-part9-fetch-url-module/#comments" itemprop="discussionUrl"><span class="post-comments-count disqus-comment-count" data-disqus-identifier="2020/06/16/Ansible-part9-fetch-url-module/" itemprop="commentCount"></span></a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>file module has a fetch module, which is the same as copy but in reverse.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">tasks:</span><br><span class="line">    - name: fetech</span><br><span class="line">      fetch: </span><br><span class="line">        src: /tmp/ansible-file-test.txt</span><br><span class="line">        dest: /tmp/</span><br><span class="line">        flat:</span><br></pre></td></tr></table></figure>

<p>go to my local machine to see /tmp directory</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">anna@ansible-controller:~/Desktop/ansible-code/inventory/modules/files-modules/inventory$ ll /tmp/ansible-node1/tmp/ansible-file-test.txt </span><br><span class="line">-rw-rw-r-- 1 anna anna 10 Jun 16 18:18 /tmp/ansible-node1/tmp/ansible-file-test.txt</span><br><span class="line">anna@ansible-controller:~/Desktop/ansible-code/inventory/modules/files-modules/inventory$ ll /tmp/cube4200/tmp/ansible-file-test.txt </span><br><span class="line">-rw-rw-r-- 1 anna anna 0 Jun 16 18:18 /tmp/cube4200/tmp/ansible-file-test.txt</span><br></pre></td></tr></table></figure>
<p>there are two hosts directories which are relate to my two hosts.</p>
<p>for the <code>flat</code>, it means ansible will not distinct the files from different hosts, the latest file will overwrite the old one.<br>for example</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">tasks:</span><br><span class="line">    - name: fetech</span><br><span class="line">      fetch: </span><br><span class="line">        src: /tmp/ansible-file-test.txt</span><br><span class="line">        dest: /tmp/</span><br><span class="line">        flat: yes</span><br></pre></td></tr></table></figure>
<p>notice: the default of flat is no, I am turning on it here, it will let the new file overwrite old file</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">anna@ansible-controller:~/Desktop/ansible-code/inventory/modules/files-modules/inventory$ ll /tmp</span><br><span class="line">total 76</span><br><span class="line">drwxrwxrwt 18 root root 4096 Jun 16 18:28  ./</span><br><span class="line">drwxr-xr-x 24 root root 4096 Jun  9 20:21  ../</span><br><span class="line">-rw-rw-r--  1 anna anna    0 Jun 16 18:28  ansible-file-test.txt</span><br></pre></td></tr></table></figure>
<p>from above, I can see there is only one <code>ansible-file-test.txt</code> file which is from cube4200, and there is no file from ansible-node1.</p>

        
      
    </div>

    
    
    
      <footer class="post-footer">
          <div class="post-eof"></div>
        
      </footer>
  </article>
  
  
  

    
        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="en">
    <link itemprop="mainEntityOfPage" href="https://vmnet8.github.io/2020/06/13/Ansible-part8-Ansible-lint/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Anna X">
      <meta itemprop="description" content="Happy coding ...">
      <meta itemprop="image" content="https://avatars0.githubusercontent.com/u/34552097">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Anna X">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
            
            <a href="/2020/06/13/Ansible-part8-Ansible-lint/" class="post-title-link" itemprop="url">Ansible-part8: Ansible lint</a>
          
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              
                
              

              <time title="Created: 2020-06-13 20:35:22 / Modified: 23:48:42" itemprop="dateCreated datePublished" datetime="2020-06-13T20:35:22-07:00">2020-06-13</time>
            </span>
          
            

            
          

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="fa fa-comment-o"></i>
      </span>
        
      
      <span class="post-meta-item-text">Disqus: </span>
    
    <a title="disqus" href="/2020/06/13/Ansible-part8-Ansible-lint/#comments" itemprop="discussionUrl"><span class="post-comments-count disqus-comment-count" data-disqus-identifier="2020/06/13/Ansible-part8-Ansible-lint/" itemprop="commentCount"></span></a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>Ansible lint: Ansible Lint is a commandline tool for linting playbooks. Use it to detect behaviors and practices that could potentially be improved.</p>
<h4 id="Install"><a href="#Install" class="headerlink" title="Install"></a>Install</h4><p>At first I try to Use pip install ansible-int, it failed.<br>then I try the apt install.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">anna@ansible-controller:~/Desktop/ansible-code/inventory/modules/set-fact module$ sudo apt install ansible-lint</span><br><span class="line">[sudo] password for anna: </span><br><span class="line">Reading package lists... Done</span><br><span class="line">Building dependency tree       </span><br><span class="line">Reading state information... Done</span><br><span class="line">The following packages were automatically installed and are no longer required:</span><br><span class="line">  golang-1.10-go golang-1.10-race-detector-runtime golang-1.10-src golang-race-detector-runtime golang-src ieee-data pkg-config python-certifi python-chardet python-jmespath python-kerberos python-libcloud python-lockfile python-netaddr</span><br><span class="line">  python-openssl python-requests python-selinux python-simplejson python-urllib3 python-xmltodict</span><br><span class="line">Use &apos;sudo apt autoremove&apos; to remove them.</span><br><span class="line">The following NEW packages will be installed:</span><br><span class="line">  ansible-lint</span><br><span class="line">0 upgraded, 1 newly installed, 0 to remove and 34 not upgraded.</span><br><span class="line">Need to get 24.8 kB of archives.</span><br><span class="line">After this operation, 146 kB of additional disk space will be used.</span><br><span class="line">Get:1 http://us.archive.ubuntu.com/ubuntu bionic/universe amd64 ansible-lint all 3.4.20+git.20180203-1 [24.8 kB]</span><br><span class="line">Fetched 24.8 kB in 0s (76.1 kB/s)     </span><br><span class="line">Selecting previously unselected package ansible-lint.</span><br><span class="line">(Reading database ... 240199 files and directories currently installed.)</span><br><span class="line">Preparing to unpack .../ansible-lint_3.4.20+git.20180203-1_all.deb ...</span><br><span class="line">Unpacking ansible-lint (3.4.20+git.20180203-1) ...</span><br><span class="line">Setting up ansible-lint (3.4.20+git.20180203-1) ...</span><br><span class="line">Processing triggers for man-db (2.8.3-2ubuntu0.1) ...</span><br><span class="line">anna@ansible-controller:~/Desktop/ansible-code/inventory/modules/set-fact module$ ansible-lint --version</span><br><span class="line">ansible-lint 3.4.20</span><br></pre></td></tr></table></figure>
<p>It shows the lint version is 3.4.20</p>
<h4 id="use-lint-to-test-yml-file"><a href="#use-lint-to-test-yml-file" class="headerlink" title="use lint to test yml file"></a>use lint to test yml file</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line">anna@ansible-controller:~/Desktop/ansible-code/inventory/modules/packaging_modules/inventory$ ansible-lint site.yml</span><br><span class="line">[ANSIBLE0002] Trailing whitespace</span><br><span class="line">site.yml:10</span><br><span class="line">        name: </span><br><span class="line"></span><br><span class="line">[ANSIBLE0010] Package installs should not use latest</span><br><span class="line">site.yml:16</span><br><span class="line">Task/Handler: test apt module</span><br></pre></td></tr></table></figure>
<p>then I go to line 10 to add ‘test package module’ after name, and save playbook.<br>after run ansible-lint</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">anna@ansible-controller:~/Desktop/ansible-code/inventory/modules/packaging_modules/inventory$ ansible-lint site.yml</span><br><span class="line">[ANSIBLE0010] Package installs should not use latest</span><br><span class="line">site.yml:16</span><br><span class="line">Task/Handler: test apt module</span><br></pre></td></tr></table></figure>
<p>It only shows the second code which needs improved. </p>
<p>after I commented out the <code>state: latest</code>, the output of <code>ansible-lint site.yml</code> shows nothing, which means nothing needs improve in this site.yml file.</p>

        
      
    </div>

    
    
    
      <footer class="post-footer">
          <div class="post-eof"></div>
        
      </footer>
  </article>
  
  
  

    
        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="en">
    <link itemprop="mainEntityOfPage" href="https://vmnet8.github.io/2020/06/13/Ansible-part7-set-facts-set-variable/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Anna X">
      <meta itemprop="description" content="Happy coding ...">
      <meta itemprop="image" content="https://avatars0.githubusercontent.com/u/34552097">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Anna X">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
            
            <a href="/2020/06/13/Ansible-part7-set-facts-set-variable/" class="post-title-link" itemprop="url">Ansible-part7: set facts, set variable</a>
          
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              
                
              

              <time title="Created: 2020-06-13 13:09:18 / Modified: 15:15:36" itemprop="dateCreated datePublished" datetime="2020-06-13T13:09:18-07:00">2020-06-13</time>
            </span>
          
            

            
          

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="fa fa-comment-o"></i>
      </span>
        
      
      <span class="post-meta-item-text">Disqus: </span>
    
    <a title="disqus" href="/2020/06/13/Ansible-part7-set-facts-set-variable/#comments" itemprop="discussionUrl"><span class="post-comments-count disqus-comment-count" data-disqus-identifier="2020/06/13/Ansible-part7-set-facts-set-variable/" itemprop="commentCount"></span></a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h4 id="what-is-set-fact"><a href="#what-is-set-fact" class="headerlink" title="what is set_fact"></a>what is set_fact</h4><p>Set fact is a module which allows setting new variables. These variables are set on a host-by-host base just like facts discovered by the setup module.</p>
<p>In ansible, there are some default info of hosts in <code>hostvars</code> variable, such as “ansible_check_mode”, “group_names” etc, and also the “ansible_facts”, which is not default show up, only when <code>gather_facts</code> is set to “yes”, it will show the details of ansible_fact. Except these two kinds of info, I can also use set_fact module to create my own info pair.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">- name: set fact</span><br><span class="line">  hosts: all</span><br><span class="line">  gather_facts: no</span><br><span class="line"></span><br><span class="line">  tasks:</span><br><span class="line">    - name: gather facts</span><br><span class="line">      debug:</span><br><span class="line">        var: hostvars[ansible_host]    #ansible_host is variable name, which means cube4200 and ansible-node1 in this case</span><br></pre></td></tr></table></figure>
<p>Let’s look at he output of this playbook,</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br></pre></td><td class="code"><pre><span class="line">anna@ansible-controller:~/Desktop/ansible-code/inventory/modules/set-fact module$ ansible-playbook site.yml </span><br><span class="line"></span><br><span class="line">PLAY [set fact] ************************************************************************</span><br><span class="line"></span><br><span class="line">TASK [gather facts] ********************************************************************</span><br><span class="line">ok: [cube4200] =&gt; &#123;</span><br><span class="line">    &quot;hostvars[ansible_host]&quot;: &#123;</span><br><span class="line">        &quot;ansible_check_mode&quot;: false, </span><br><span class="line">        &quot;ansible_connection&quot;: &quot;ssh&quot;, </span><br><span class="line">        &quot;ansible_diff_mode&quot;: false, </span><br><span class="line">        &quot;ansible_facts&quot;: &#123;&#125;, </span><br><span class="line">        &quot;ansible_forks&quot;: 5, </span><br><span class="line">        &quot;ansible_inventory_sources&quot;: [</span><br><span class="line">            &quot;/home/anna/Desktop/ansible-code/inventory/modules/set-fact module/hosts&quot;</span><br><span class="line">        ], </span><br><span class="line">        &quot;ansible_playbook_python&quot;: &quot;/usr/bin/python2&quot;, </span><br><span class="line">        &quot;ansible_run_tags&quot;: [</span><br><span class="line">            &quot;all&quot;</span><br><span class="line">        ], </span><br><span class="line">        &quot;ansible_skip_tags&quot;: [], </span><br><span class="line">        &quot;ansible_user&quot;: &quot;anna&quot;, </span><br><span class="line">        &quot;ansible_verbosity&quot;: 0, </span><br><span class="line">        &quot;ansible_version&quot;: &#123;</span><br><span class="line">            &quot;full&quot;: &quot;2.9.9&quot;, </span><br><span class="line">            &quot;major&quot;: 2, </span><br><span class="line">            &quot;minor&quot;: 9, </span><br><span class="line">            &quot;revision&quot;: 9, </span><br><span class="line">            &quot;string&quot;: &quot;2.9.9&quot;</span><br><span class="line">        &#125;, </span><br><span class="line">        &quot;group_names&quot;: [</span><br><span class="line">            &quot;web2&quot;</span><br><span class="line">        ], </span><br><span class="line">        &quot;groups&quot;: &#123;</span><br><span class="line">            &quot;all&quot;: [</span><br><span class="line">                &quot;cube4200&quot;, </span><br><span class="line">                &quot;ansible-node1&quot;</span><br><span class="line">            ], </span><br><span class="line">            &quot;ungrouped&quot;: [], </span><br><span class="line">            &quot;web1&quot;: [</span><br><span class="line">                &quot;ansible-node1&quot;</span><br><span class="line">            ], </span><br><span class="line">            &quot;web2&quot;: [</span><br><span class="line">                &quot;cube4200&quot;</span><br><span class="line">            ]</span><br><span class="line">        &#125;, </span><br><span class="line">        &quot;inventory_dir&quot;: &quot;/home/anna/Desktop/ansible-code/inventory/modules/set-fact module&quot;, </span><br><span class="line">        &quot;inventory_file&quot;: &quot;/home/anna/Desktop/ansible-code/inventory/modules/set-fact module/hosts&quot;, </span><br><span class="line">        &quot;inventory_hostname&quot;: &quot;cube4200&quot;, </span><br><span class="line">        &quot;inventory_hostname_short&quot;: &quot;cube4200&quot;, </span><br><span class="line">        &quot;omit&quot;: &quot;__omit_place_holder__a53469922527cea947bde7fea01f0f911fe92d8c&quot;, </span><br><span class="line">        &quot;playbook_dir&quot;: &quot;/home/anna/Desktop/ansible-code/inventory/modules/set-fact module&quot;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">ok: [ansible-node1] =&gt; &#123;</span><br><span class="line">    &quot;hostvars[ansible_host]&quot;: &#123;</span><br><span class="line">        &quot;ansible_check_mode&quot;: false, </span><br><span class="line">        &quot;ansible_connection&quot;: &quot;ssh&quot;, </span><br><span class="line">        &quot;ansible_diff_mode&quot;: false, </span><br><span class="line">        &quot;ansible_facts&quot;: &#123;&#125;, </span><br><span class="line">        &quot;ansible_forks&quot;: 5, </span><br><span class="line">        &quot;ansible_inventory_sources&quot;: [</span><br><span class="line">            &quot;/home/anna/Desktop/ansible-code/inventory/modules/set-fact module/hosts&quot;</span><br><span class="line">        ], </span><br><span class="line">        &quot;ansible_playbook_python&quot;: &quot;/usr/bin/python2&quot;, </span><br><span class="line">        &quot;ansible_run_tags&quot;: [</span><br><span class="line">            &quot;all&quot;</span><br><span class="line">        ], </span><br><span class="line">        &quot;ansible_skip_tags&quot;: [], </span><br><span class="line">        &quot;ansible_user&quot;: &quot;pi&quot;, </span><br><span class="line">        &quot;ansible_verbosity&quot;: 0, </span><br><span class="line">        &quot;ansible_version&quot;: &#123;</span><br><span class="line">            &quot;full&quot;: &quot;2.9.9&quot;, </span><br><span class="line">            &quot;major&quot;: 2, </span><br><span class="line">            &quot;minor&quot;: 9, </span><br><span class="line">            &quot;revision&quot;: 9, </span><br><span class="line">            &quot;string&quot;: &quot;2.9.9&quot;</span><br><span class="line">        &#125;, </span><br><span class="line">        &quot;group_names&quot;: [</span><br><span class="line">            &quot;web1&quot;</span><br><span class="line">        ], </span><br><span class="line">        &quot;groups&quot;: &#123;</span><br><span class="line">            &quot;all&quot;: [</span><br><span class="line">                &quot;cube4200&quot;, </span><br><span class="line">                &quot;ansible-node1&quot;</span><br><span class="line">            ], </span><br><span class="line">            &quot;ungrouped&quot;: [], </span><br><span class="line">            &quot;web1&quot;: [</span><br><span class="line">                &quot;ansible-node1&quot;</span><br><span class="line">            ], </span><br><span class="line">            &quot;web2&quot;: [</span><br><span class="line">                &quot;cube4200&quot;</span><br><span class="line">            ]</span><br><span class="line">        &#125;, </span><br><span class="line">        &quot;inventory_dir&quot;: &quot;/home/anna/Desktop/ansible-code/inventory/modules/set-fact module&quot;, </span><br><span class="line">        &quot;inventory_file&quot;: &quot;/home/anna/Desktop/ansible-code/inventory/modules/set-fact module/hosts&quot;, </span><br><span class="line">        &quot;inventory_hostname&quot;: &quot;ansible-node1&quot;, </span><br><span class="line">        &quot;inventory_hostname_short&quot;: &quot;ansible-node1&quot;, </span><br><span class="line">        &quot;omit&quot;: &quot;__omit_place_holder__a53469922527cea947bde7fea01f0f911fe92d8c&quot;, </span><br><span class="line">        &quot;playbook_dir&quot;: &quot;/home/anna/Desktop/ansible-code/inventory/modules/set-fact module&quot;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">PLAY RECAP *****************************************************************************</span><br><span class="line">ansible-node1              : ok=1    changed=0    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   </span><br><span class="line">cube4200                   : ok=1    changed=0    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0</span><br></pre></td></tr></table></figure>
<p>eventhought <code>gather_facts</code> is “no”, ansible still show some basic info of every hosts.<br>If <code>gather_facts</code> is “yes”, except the default info, ansible will show <code>ansible-facts</code> info which included a lots of system info of every hosts.</p>
          <!--noindex-->
          
            <div class="post-button">
              <a class="btn" href="/2020/06/13/Ansible-part7-set-facts-set-variable/#more" rel="contents">
                Read more &raquo;
              </a>
            </div>
          
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
          <div class="post-eof"></div>
        
      </footer>
  </article>
  
  
  

    
        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="en">
    <link itemprop="mainEntityOfPage" href="https://vmnet8.github.io/2020/06/03/Ansible-part6-ansible-vault-encrypt-file/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Anna X">
      <meta itemprop="description" content="Happy coding ...">
      <meta itemprop="image" content="https://avatars0.githubusercontent.com/u/34552097">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Anna X">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
            
            <a href="/2020/06/03/Ansible-part6-ansible-vault-encrypt-file/" class="post-title-link" itemprop="url">Ansible part6: ansible vault encrypt file</a>
          
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              
                
              

              <time title="Created: 2020-06-03 00:24:34 / Modified: 14:47:15" itemprop="dateCreated datePublished" datetime="2020-06-03T00:24:34-07:00">2020-06-03</time>
            </span>
          
            

            
          

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="fa fa-comment-o"></i>
      </span>
        
      
      <span class="post-meta-item-text">Disqus: </span>
    
    <a title="disqus" href="/2020/06/03/Ansible-part6-ansible-vault-encrypt-file/#comments" itemprop="discussionUrl"><span class="post-comments-count disqus-comment-count" data-disqus-identifier="2020/06/03/Ansible-part6-ansible-vault-encrypt-file/" itemprop="commentCount"></span></a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>Ansible Vault is a feature of ansible that allows you to keep sensitive data such as passwords or keys in encrypted files, rather than as plaintext in playbooks or roles. These vault files can then be distributed or placed in source control.</p>
<h4 id="encrypt-a-file-using-ansible-vault"><a href="#encrypt-a-file-using-ansible-vault" class="headerlink" title="encrypt a file using ansible-vault"></a>encrypt a file using ansible-vault</h4><p>I created a vars file to test ansible-vault command</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">port: 443</span><br><span class="line">greeting: &quot;greeting from vars file&quot;</span><br><span class="line">ansible_user: pi</span><br></pre></td></tr></table></figure>
          <!--noindex-->
          
            <div class="post-button">
              <a class="btn" href="/2020/06/03/Ansible-part6-ansible-vault-encrypt-file/#more" rel="contents">
                Read more &raquo;
              </a>
            </div>
          
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
          <div class="post-eof"></div>
        
      </footer>
  </article>
  
  
  

    
        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="en">
    <link itemprop="mainEntityOfPage" href="https://vmnet8.github.io/2020/06/02/Ansible-part5-how-to-use-module/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Anna X">
      <meta itemprop="description" content="Happy coding ...">
      <meta itemprop="image" content="https://avatars0.githubusercontent.com/u/34552097">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Anna X">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
            
            <a href="/2020/06/02/Ansible-part5-how-to-use-module/" class="post-title-link" itemprop="url">Ansible part5: how to use module - command module and register and return value of module</a>
          
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              
                
              

              <time title="Created: 2020-06-02 14:03:25" itemprop="dateCreated datePublished" datetime="2020-06-02T14:03:25-07:00">2020-06-02</time>
            </span>
          
            

            
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-06-03 00:16:11" itemprop="dateModified" datetime="2020-06-03T00:16:11-07:00">2020-06-03</time>
              </span>
            
          

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="fa fa-comment-o"></i>
      </span>
        
      
      <span class="post-meta-item-text">Disqus: </span>
    
    <a title="disqus" href="/2020/06/02/Ansible-part5-how-to-use-module/#comments" itemprop="discussionUrl"><span class="post-comments-count disqus-comment-count" data-disqus-identifier="2020/06/02/Ansible-part5-how-to-use-module/" itemprop="commentCount"></span></a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>In this session, I am going to talk about command module.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">tasks:</span><br><span class="line">    - name: test command module</span><br><span class="line">      command: cat /etc/hosts</span><br></pre></td></tr></table></figure>
<p>the playbook is pretty simple, let’s look at output</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">anna@ansible-controller:~/Desktop/ansible-code/inventory/modules/command-modules$ ansible-playbook site.yml </span><br><span class="line"></span><br><span class="line">PLAY [test command module] ******************************************************</span><br><span class="line"></span><br><span class="line">TASK [test command module] ******************************************************</span><br><span class="line">changed: [ansible-node1]</span><br><span class="line">changed: [cube4200]</span><br><span class="line"></span><br><span class="line">PLAY RECAP **********************************************************************</span><br><span class="line">ansible-node1              : ok=1    changed=1    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   </span><br><span class="line">cube4200                   : ok=1    changed=1    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0</span><br></pre></td></tr></table></figure>
<p>It shows successfully exectute ansible tasks, but I didn’t see the context of /etc/hosts.</p>
<p>If I want to see the output, I am supposed to let output to be a variable, it looks like following:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">tasks:</span><br><span class="line">    - name: test command module</span><br><span class="line">      command: cat /etc/hosts</span><br><span class="line">      register: output</span><br><span class="line">    - name: print the output of command</span><br><span class="line">      debug:</span><br><span class="line">        msg: &quot;&#123;&#123; output &#125;&#125;&quot;</span><br></pre></td></tr></table></figure>
<p>after adding register, I can see the /etc/hosts now.</p>
          <!--noindex-->
          
            <div class="post-button">
              <a class="btn" href="/2020/06/02/Ansible-part5-how-to-use-module/#more" rel="contents">
                Read more &raquo;
              </a>
            </div>
          
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
          <div class="post-eof"></div>
        
      </footer>
  </article>
  
  
  

    
        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="en">
    <link itemprop="mainEntityOfPage" href="https://vmnet8.github.io/2020/06/02/Ansible-part4-how-to-use-modules-net-tools/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Anna X">
      <meta itemprop="description" content="Happy coding ...">
      <meta itemprop="image" content="https://avatars0.githubusercontent.com/u/34552097">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Anna X">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
            
            <a href="/2020/06/02/Ansible-part4-how-to-use-modules-net-tools/" class="post-title-link" itemprop="url">Ansible part4: how to use modules - net tools get url</a>
          
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              
                
              

              <time title="Created: 2020-06-02 11:53:29 / Modified: 13:53:23" itemprop="dateCreated datePublished" datetime="2020-06-02T11:53:29-07:00">2020-06-02</time>
            </span>
          
            

            
          

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="fa fa-comment-o"></i>
      </span>
        
      
      <span class="post-meta-item-text">Disqus: </span>
    
    <a title="disqus" href="/2020/06/02/Ansible-part4-how-to-use-modules-net-tools/#comments" itemprop="discussionUrl"><span class="post-comments-count disqus-comment-count" data-disqus-identifier="2020/06/02/Ansible-part4-how-to-use-modules-net-tools/" itemprop="commentCount"></span></a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>If I am going to download an python archived file from python.org, I need to use net tools and file module to achieve my goal.</p>
<h4 id="Net-tools-module-get-url"><a href="#Net-tools-module-get-url" class="headerlink" title="Net tools module: get_url"></a>Net tools module: get_url</h4><p>playbook:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">tasks:</span><br><span class="line">   - name: mkdir</span><br><span class="line">     file:</span><br><span class="line">      path: /tmp/python-download/    # use file module to create directory name /tmp/python-download</span><br><span class="line">      state: directory</span><br><span class="line">   - name: get url</span><br><span class="line">     get_url:</span><br><span class="line">       url: https://www.python.org/ftp/python/3.8.3/Python-3.8.3.tgz    # the download url</span><br><span class="line">       dest: /tmp/python-download/</span><br></pre></td></tr></table></figure>
<p>output:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">anna@ansible-controller:~/Desktop/ansible-code/inventory/modules/net-tools-modules$ ansible-playbook site.yml </span><br><span class="line"></span><br><span class="line">PLAY [test net tool get_url] ****************************************************</span><br><span class="line"></span><br><span class="line">TASK [Gathering Facts] **********************************************************</span><br><span class="line">ok: [ansible-node1]</span><br><span class="line">ok: [cube4200]</span><br><span class="line"></span><br><span class="line">TASK [mkdir] ********************************************************************</span><br><span class="line">changed: [ansible-node1]</span><br><span class="line">changed: [cube4200]</span><br><span class="line"></span><br><span class="line">TASK [get url] ******************************************************************</span><br><span class="line">changed: [ansible-node1]</span><br><span class="line">changed: [cube4200]</span><br><span class="line"></span><br><span class="line">PLAY RECAP **********************************************************************</span><br><span class="line">ansible-node1              : ok=3    changed=2    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   </span><br><span class="line">cube4200                   : ok=3    changed=2    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0</span><br></pre></td></tr></table></figure>
<p>we can check if the python file  has been downloaded.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">anna@ansible-controller:~/Desktop/ansible-code/inventory/modules/net-tools-modules$ ansible all -m shell -a &quot;ls /tmp/python-download&quot;</span><br><span class="line">ansible-node1 | CHANGED | rc=0 &gt;&gt;</span><br><span class="line">Python-3.8.3.tgz</span><br><span class="line">cube4200 | CHANGED | rc=0 &gt;&gt;</span><br><span class="line">Python-3.8.3.tgz</span><br></pre></td></tr></table></figure>
<p>It shows Python-3.8.3.tgz already downloaded.</p>
<h4 id="file-modules-unarchive"><a href="#file-modules-unarchive" class="headerlink" title="file modules: unarchive"></a>file modules: unarchive</h4><p>In order to unarchive Python-3.8.3.tgz, I need to use unarchive module</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">- name: unarchive compress file</span><br><span class="line">      unarchive:</span><br><span class="line">        src: /tmp/python-download/Python-3.8.3.tgz</span><br><span class="line">        dest: /etc/tmp</span><br><span class="line">        remote_src: yes   #indicate the archived file is already on the remote system and not local to the Ansible controller.</span><br></pre></td></tr></table></figure>
<p>Notice: <code>remote_src</code> default is no, which means ansible is going to find Python-3.8.3.tgz at my local machine, but actually this file already is in remote, so I need to switch to yes.</p>
<p>output is:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">anna@ansible-controller:~/Desktop/ansible-code/inventory/modules/net-tools-modules$ ansible-playbook site.yml </span><br><span class="line"></span><br><span class="line">TASK [unarchive compress file] *****************************************************************************************************************************************************************************************************************</span><br><span class="line">changed: [cube4200]</span><br><span class="line">changed: [ansible-node1]</span><br><span class="line"></span><br><span class="line">PLAY RECAP *************************************************************************************************************************************************************************************************************************************</span><br><span class="line">ansible-node1              : ok=4    changed=1    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   </span><br><span class="line">cube4200                   : ok=4    changed=1    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   </span><br><span class="line"></span><br><span class="line">anna@ansible-controller:~/Desktop/ansible-code/inventory/modules/net-tools-modules$ ansible all -m shell -a  &quot;ls /etc/tmp&quot;</span><br><span class="line">cube4200 | CHANGED | rc=0 &gt;&gt;</span><br><span class="line">Python-3.8.3</span><br><span class="line">ansible-node1 | CHANGED | rc=0 &gt;&gt;</span><br><span class="line">Python-3.8.3</span><br></pre></td></tr></table></figure>

        
      
    </div>

    
    
    
      <footer class="post-footer">
          <div class="post-eof"></div>
        
      </footer>
  </article>
  
  
  

    
        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="en">
    <link itemprop="mainEntityOfPage" href="https://vmnet8.github.io/2020/05/27/Ansible-part3-how-to-use-modules/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Anna X">
      <meta itemprop="description" content="Happy coding ...">
      <meta itemprop="image" content="https://avatars0.githubusercontent.com/u/34552097">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Anna X">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
            
            <a href="/2020/05/27/Ansible-part3-how-to-use-modules/" class="post-title-link" itemprop="url">Ansible-part3: how to use modules - yum apt package</a>
          
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              
                
              

              <time title="Created: 2020-05-27 00:17:59" itemprop="dateCreated datePublished" datetime="2020-05-27T00:17:59-07:00">2020-05-27</time>
            </span>
          
            

            
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-06-02 11:33:31" itemprop="dateModified" datetime="2020-06-02T11:33:31-07:00">2020-06-02</time>
              </span>
            
          

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="fa fa-comment-o"></i>
      </span>
        
      
      <span class="post-meta-item-text">Disqus: </span>
    
    <a title="disqus" href="/2020/05/27/Ansible-part3-how-to-use-modules/#comments" itemprop="discussionUrl"><span class="post-comments-count disqus-comment-count" data-disqus-identifier="2020/05/27/Ansible-part3-how-to-use-modules/" itemprop="commentCount"></span></a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h4 id="packaging-module-yum"><a href="#packaging-module-yum" class="headerlink" title="packaging module: yum"></a>packaging module: yum</h4><p>yum is CentOS Linux package management tool.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">tasks:</span><br><span class="line">    - name: upgrade all packages</span><br><span class="line">      yum:</span><br><span class="line">        name: &apos;*&apos;   # update all packages</span><br><span class="line">        state: latest</span><br><span class="line">    - name: install a package</span><br><span class="line">      yum:</span><br><span class="line">        name: git</span><br><span class="line">        state: latest</span><br></pre></td></tr></table></figure>
<p>output is:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">anna@ansible-controller:~/Desktop/ansible-code/inventory/modules/packaging_modules/inventory$ ansible-playbook site.yml </span><br><span class="line"></span><br><span class="line">PLAY [test packageing modules] **************************************************</span><br><span class="line"></span><br><span class="line">TASK [upgrade all packages] *****************************************************</span><br><span class="line">changed: [cube4200]</span><br><span class="line"></span><br><span class="line">TASK [install a package] ********************************************************</span><br><span class="line">changed: [cube4200]</span><br><span class="line"></span><br><span class="line">PLAY RECAP **********************************************************************</span><br><span class="line">cube4200                   : ok=2    changed=2    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   </span><br><span class="line">[anna@cube4200 ~]$ which git</span><br><span class="line">/usr/bin/git</span><br><span class="line">[anna@cube4200 ~]$ git --version</span><br><span class="line">git version 1.8.3.1</span><br></pre></td></tr></table></figure>
<p>Notice: the update task took long time to update  all packages.</p>
<h4 id="packaging-module-apt"><a href="#packaging-module-apt" class="headerlink" title="packaging module: apt"></a>packaging module: apt</h4><p>apt is Ubuntu package management tool.</p>
<p>In this example, I am going to install git in two different linux, one use yum on CentOS, anther one use apt on Debian. So I need to add some condition to let ansible know which node should use yum or apt.<br>Before running site.yml  I can use <code>ansible web1 -m gather_facts |grep distribution</code> to see the OS of nodes.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">tasks:</span><br><span class="line">    - name: test yum module</span><br><span class="line">      yum:</span><br><span class="line">        name: git</span><br><span class="line">        state: latest</span><br><span class="line">      when: ansible_facts[&apos;distribution&apos;] == &quot;CentOS&quot;    # this is from gather_facts</span><br><span class="line">    - name: test apt module</span><br><span class="line">      apt:</span><br><span class="line">        name: git</span><br><span class="line">        state: latest</span><br><span class="line">      when: ansible_facts[&apos;distribution&apos;] == &quot;Debian&quot;</span><br></pre></td></tr></table></figure>

<p>During running, I can see ansible will judge which command (apt or yum) to use.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">anna@ansible-controller:~/Desktop/ansible-code/inventory/modules/packaging_modules/inventory$ ansible-playbook site.yml </span><br><span class="line"></span><br><span class="line">PLAY [test packageing modules] **************************************************</span><br><span class="line"></span><br><span class="line">TASK [Gathering Facts] **********************************************************</span><br><span class="line">ok: [ansible-node1]</span><br><span class="line">ok: [cube4200]</span><br><span class="line"></span><br><span class="line">TASK [test yum module] **********************************************************</span><br><span class="line">skipping: [ansible-node1]</span><br><span class="line">changed: [cube4200]</span><br><span class="line"></span><br><span class="line">TASK [test apt module] **********************************************************</span><br><span class="line">skipping: [cube4200]</span><br><span class="line">ok: [ansible-node1]</span><br><span class="line"></span><br><span class="line">PLAY RECAP **********************************************************************</span><br><span class="line">ansible-node1              : ok=2    changed=0    unreachable=0    failed=0    skipped=1    rescued=0    ignored=0   </span><br><span class="line">cube4200                   : ok=2    changed=1    unreachable=0    failed=0    skipped=1    rescued=0    ignored=0</span><br></pre></td></tr></table></figure>
<p>cube4200 uses CentOS, so when testing apt command, it is skipped; ansible_node1 uses Debian, which is skipped when testing yum.</p>
<h4 id="packaging-module-package"><a href="#packaging-module-package" class="headerlink" title="packaging module: package"></a>packaging module: package</h4><p>package module is more general and simplify the installing packages</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">tasks:</span><br><span class="line">    - name: test package module</span><br><span class="line">      package:</span><br><span class="line">        name: git</span><br><span class="line">        state: latest</span><br></pre></td></tr></table></figure>

<p>Notice: sometime package will have different name in different OS, under this situation, package module will not work, I still need to use yum or apt with gather_facts conditon to install packages.</p>

        
      
    </div>

    
    
    
      <footer class="post-footer">
          <div class="post-eof"></div>
        
      </footer>
  </article>
  
  
  

    
        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="en">
    <link itemprop="mainEntityOfPage" href="https://vmnet8.github.io/2020/05/23/Ansible-part-2-examples-of-how-to-use-modules/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Anna X">
      <meta itemprop="description" content="Happy coding ...">
      <meta itemprop="image" content="https://avatars0.githubusercontent.com/u/34552097">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Anna X">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
            
            <a href="/2020/05/23/Ansible-part-2-examples-of-how-to-use-modules/" class="post-title-link" itemprop="url">Ansible part 2: how to use modules - debug copy file template ping gather-facts user group</a>
          
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              
                
              

              <time title="Created: 2020-05-23 23:04:19" itemprop="dateCreated datePublished" datetime="2020-05-23T23:04:19-07:00">2020-05-23</time>
            </span>
          
            

            
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-06-02 11:39:52" itemprop="dateModified" datetime="2020-06-02T11:39:52-07:00">2020-06-02</time>
              </span>
            
          

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="fa fa-comment-o"></i>
      </span>
        
      
      <span class="post-meta-item-text">Disqus: </span>
    
    <a title="disqus" href="/2020/05/23/Ansible-part-2-examples-of-how-to-use-modules/#comments" itemprop="discussionUrl"><span class="post-comments-count disqus-comment-count" data-disqus-identifier="2020/05/23/Ansible-part-2-examples-of-how-to-use-modules/" itemprop="commentCount"></span></a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h4 id="Ansible-configuration"><a href="#Ansible-configuration" class="headerlink" title="Ansible configuration"></a>Ansible configuration</h4><p>Before running ansible,I am going to write a default inventory which will be used when I am running site.yml.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[defaults]</span><br><span class="line">inventory = hosts</span><br></pre></td></tr></table></figure>

<h4 id="Ansible-commands"><a href="#Ansible-commands" class="headerlink" title="Ansible commands"></a>Ansible commands</h4><p>Instead of using ansible playbook, I can also use ansible command to run automation, for example, I am going to check remote nodes directories, I can use ansible command to do that directly, no need to login romote node to check.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">anna@ansible-controller:~/Desktop/ansible-code/inventory/modules/files-modules/inventory$ ansible all -m shell -a &quot;ls /etc/tmp&quot;</span><br><span class="line">ansible-node1 | SUCCESS | rc=0 &gt;&gt;</span><br><span class="line">ansible-file-test.txt</span><br><span class="line">ansible-file-test.txt.16075.2020-05-24@22:58:43~</span><br><span class="line"></span><br><span class="line">cube4200 | SUCCESS | rc=0 &gt;&gt;</span><br><span class="line">ansible-file-test.txt</span><br><span class="line">ansible-file-test.txt.11629.2020-05-24@15:58:44~</span><br></pre></td></tr></table></figure>
<p>The command I used is  <code>ansible all -m shell -a &quot;ls /etc/tmp&quot;</code></p>
<h4 id="some-examples-of-how-to-use-modules"><a href="#some-examples-of-how-to-use-modules" class="headerlink" title="some examples of how to use modules"></a>some examples of how to use modules</h4><h5 id="Utilities-modules-gt-debug-gt-print-statements-during-execution"><a href="#Utilities-modules-gt-debug-gt-print-statements-during-execution" class="headerlink" title="Utilities modules -&gt; debug -&gt; print statements during execution"></a>Utilities modules -&gt; debug -&gt; print statements during execution</h5><p>In this module, only three parameters.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">- name: hello world</span><br><span class="line">  hosts: localhost</span><br><span class="line">  tasks:</span><br><span class="line">   - name: hello world</span><br><span class="line">     debug:</span><br><span class="line">      msg: &quot;hello ansible&quot;</span><br><span class="line">      verbosity: 0     # 0 is default, 1-3 parameters will skip the message</span><br></pre></td></tr></table></figure>
          <!--noindex-->
          
            <div class="post-button">
              <a class="btn" href="/2020/05/23/Ansible-part-2-examples-of-how-to-use-modules/#more" rel="contents">
                Read more &raquo;
              </a>
            </div>
          
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
          <div class="post-eof"></div>
        
      </footer>
  </article>
  
  
  

    
        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="en">
    <link itemprop="mainEntityOfPage" href="https://vmnet8.github.io/2020/05/21/Ansible-deploy-enviroment-and-concept/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Anna X">
      <meta itemprop="description" content="Happy coding ...">
      <meta itemprop="image" content="https://avatars0.githubusercontent.com/u/34552097">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Anna X">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
            
            <a href="/2020/05/21/Ansible-deploy-enviroment-and-concept/" class="post-title-link" itemprop="url">Ansible part 1: deploy enviroment and most important concepts</a>
          
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              
                
              

              <time title="Created: 2020-05-21 17:31:05" itemprop="dateCreated datePublished" datetime="2020-05-21T17:31:05-07:00">2020-05-21</time>
            </span>
          
            

            
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-05-26 23:11:34" itemprop="dateModified" datetime="2020-05-26T23:11:34-07:00">2020-05-26</time>
              </span>
            
          

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="fa fa-comment-o"></i>
      </span>
        
      
      <span class="post-meta-item-text">Disqus: </span>
    
    <a title="disqus" href="/2020/05/21/Ansible-deploy-enviroment-and-concept/#comments" itemprop="discussionUrl"><span class="post-comments-count disqus-comment-count" data-disqus-identifier="2020/05/21/Ansible-deploy-enviroment-and-concept/" itemprop="commentCount"></span></a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="what-is-Ansible"><a href="#what-is-Ansible" class="headerlink" title="what is Ansible"></a>what is Ansible</h2><p>Ansible is an IT automation tool. It can configure systems, deploy software, and orchestrate more advanced IT tasks such as continuous deployments or zero downtime rolling updates.</p>
<p>There are three main parts in Ansible: inventory, playbook and modules.</p>
<h3 id="Inventory"><a href="#Inventory" class="headerlink" title="Inventory"></a>Inventory</h3><p>Inventory is a list of managed nodes. An inventory file is also sometimes called a “hostfile”. Your inventory can specify information like IP address for each managed node. An inventory can also organize managed nodes, creating and nesting groups for easier scaling.</p>
<p>For my enviroment, there are two nodes:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[web1]</span><br><span class="line">ansible-node1 ansible_connection=ssh ansible_user=pi</span><br><span class="line">[web2]</span><br><span class="line">cube4200 ansible_connection=ssh ansible_user=anna</span><br></pre></td></tr></table></figure>


<h3 id="Playbooks"><a href="#Playbooks" class="headerlink" title="Playbooks"></a>Playbooks</h3><p>Playbooks are Ansible’s configuration, deployment and orchestration language. Each playbook is composed of one or more ‘plays’ in a list.</p>
<p>Playsbook is yaml file. there are listed tasks you want ansible to work.<br>Playbook is the most important file in ansible.</p>
<p>In playbooks, there are some important concepts, such as variables, variables files, loops.</p>
<h4 id="variables"><a href="#variables" class="headerlink" title="variables"></a>variables</h4><p><a href="https://docs.ansible.com/ansible/latest/user_guide/playbooks_variables.html" target="_blank" rel="noopener">playbook variables</a> can be wrote directly in playbook or in variable files. all kinds variabls have their precendence during playbook exectued. </p>
          <!--noindex-->
          
            <div class="post-button">
              <a class="btn" href="/2020/05/21/Ansible-deploy-enviroment-and-concept/#more" rel="contents">
                Read more &raquo;
              </a>
            </div>
          
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
          <div class="post-eof"></div>
        
      </footer>
  </article>
  
  
  

    
  </div>

  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><span class="space">&hellip;</span><a class="page-number" href="/page/5/">5</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right" aria-label="Next page"></i></a>
  </nav>



          </div>
          

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image"
      src="https://avatars0.githubusercontent.com/u/34552097"
      alt="Anna X">
  <p class="site-author-name" itemprop="name">Anna X</p>
  <div class="site-description" itemprop="description">Happy coding ...</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        
          <a href="/archives/%20%7C%7C%20archive">
        
          <span class="site-state-item-count">49</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
    
      
      
      <div class="site-state-item site-state-tags">
        
          
            <a href="/tags/%20%7C%7C%20tags">
          
        
        <span class="site-state-item-count">19</span>
        <span class="site-state-item-name">tags</span>
        </a>
      </div>
    
  </nav>
</div>
  <div class="feed-link motion-element">
    <a href="/atom.xml" rel="alternate">
      <i class="fa fa-rss"></i>RSS
    </a>
  </div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
      
      
        
      
      
        
      
        <a href="https://github.com/vmnet8" title="GitHub &amp;rarr; https:&#x2F;&#x2F;github.com&#x2F;vmnet8" rel="noopener" target="_blank"><i class="fa fa-fw fa-github"></i>GitHub</a>
      </span>
    
      <span class="links-of-author-item">
      
      
        
      
      
        
      
        <a href="https://www.linkedin.com/in/anna-x/" title="Linkedin &amp;rarr; https:&#x2F;&#x2F;www.linkedin.com&#x2F;in&#x2F;anna-x&#x2F;" rel="noopener" target="_blank"><i class="fa fa-fw fa-linkedin"></i>Linkedin</a>
      </span>
    
      <span class="links-of-author-item">
      
      
        
      
      
        
      
        <a href="mailto:vmnet8@gmail.com" title="E-Mail &amp;rarr; mailto:vmnet8@gmail.com" rel="noopener" target="_blank"><i class="fa fa-fw fa-envelope"></i>E-Mail</a>
      </span>
    
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2020</span>
  <span class="with-love" id="animate">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Anna X</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> v4.0.0</div>
  <span class="post-meta-divider">|</span>
  <div class="theme-info">Theme – <a href="https://theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a> v7.4.1</div>

        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="Total Visitors">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
  
    <span class="post-meta-divider">|</span>
  
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="Total Views">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
  
</div>












        
      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js?v=3.1.0"></script>
  <script src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  <script src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
<script src="/js/utils.js?v=7.4.1"></script><script src="/js/motion.js?v=7.4.1"></script>
<script src="/js/schemes/pisces.js?v=7.4.1"></script>
<script src="/js/next-boot.js?v=7.4.1"></script>



  








  <script src="/js/local-search.js?v=7.4.1"></script>














  

  

  

<script>
  function loadCount() {
    var d = document, s = d.createElement('script');
    s.src = 'https://annax.disqus.com/count.js';
    s.id = 'dsq-count-scr';
    (d.head || d.body).appendChild(s);
  }
  // defer loading until the whole page loading is completed
  window.addEventListener('load', loadCount, false);
</script>

</body>
</html>
